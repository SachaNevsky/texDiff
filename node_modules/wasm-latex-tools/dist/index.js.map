{"version":3,"file":"index.js","sources":["../src/utils/logger.ts","../src/utils/error-handler.ts","../src/core/webperl-runner.ts","../src/core/filesystem-manager.ts","../src/core/script-loader.ts","../src/tools/base-tool.ts","../src/tools/texcount.ts","../src/tools/latexdiff.ts","../src/tools/texfmt.ts","../src/tools/latexpand.ts"],"sourcesContent":["export class Logger {\n    constructor(private verbose: boolean = false) { }\n\n    debug(message: string, ...args: any[]): void {\n        if (this.verbose) {\n            console.debug(`[WebPerl Debug] ${message}`, ...args);\n        }\n    }\n\n    info(message: string, ...args: any[]): void {\n        console.info(`[WebPerl] ${message}`, ...args);\n    }\n\n    warn(message: string, ...args: any[]): void {\n        console.warn(`[WebPerl Warning] ${message}`, ...args);\n    }\n\n    error(message: string, ...args: any[]): void {\n        console.error(`[WebPerl Error] ${message}`, ...args);\n    }\n}","export class ErrorHandler {\n    static handle(error: unknown, context?: string): Error {\n        const message = this.getMessage(error);\n        const fullMessage = context ? `${context}: ${message}` : message;\n        return new Error(fullMessage);\n    }\n\n    static getMessage(error: unknown): string {\n        if (error instanceof Error) {\n            return error.message;\n        }\n        return String(error);\n    }\n}","import { WebPerlConfig, ScriptResult } from './types';\nimport { Logger } from '../utils/logger';\nimport { ErrorHandler } from '../utils/error-handler';\n\nexport class WebPerlRunner {\n    private config: Required<WebPerlConfig>;\n    private logger: Logger;\n    private initialized: boolean = false;\n    private initializing: boolean = false;\n    private perlRunnerIframe: HTMLIFrameElement | null = null;\n    private perlRunner: Window | null = null;\n\n    constructor(config: WebPerlConfig = {}) {\n        this.config = {\n            webperlBasePath: config.webperlBasePath || '/core/webperl',\n            perlScriptsPath: config.perlScriptsPath || '/core/perl',\n            verbose: config.verbose ?? false\n        };\n        this.logger = new Logger(this.config.verbose);\n    }\n\n    async initialize(): Promise<void> {\n        if (this.initialized) return;\n        if (this.initializing) {\n            await this.waitForInitialization();\n            return;\n        }\n\n        this.initializing = true;\n        this.logger.info('Initializing WebPerl...');\n\n        try {\n            await this.loadPerlRunner();\n            this.initialized = true;\n            this.logger.info('WebPerl initialized successfully');\n        } catch (error) {\n            this.initializing = false;\n            throw ErrorHandler.handle(error, 'Failed to initialize WebPerl');\n        } finally {\n            this.initializing = false;\n        }\n    }\n\n    private async loadPerlRunner(): Promise<void> {\n        return new Promise((resolve, reject) => {\n            const timeout = setTimeout(() => {\n                reject(new Error('Timeout waiting for Perl runner to initialize'));\n            }, 30000);\n\n            const messageHandler = (event: MessageEvent) => {\n                const data = event.data;\n\n                if (data.perlRunnerState === 'Ready') {\n                    clearTimeout(timeout);\n                    window.removeEventListener('message', messageHandler);\n                    this.perlRunner = event.source as Window;\n                    this.logger.debug('Perl runner is ready');\n                    resolve();\n                }\n            };\n\n            window.addEventListener('message', messageHandler);\n\n            this.perlRunnerIframe = document.createElement('iframe');\n            this.perlRunnerIframe.name = 'perlrunner';\n            this.perlRunnerIframe.src = `${this.config.webperlBasePath}/perlrunner.html`;\n            this.perlRunnerIframe.style.display = 'none';\n\n            this.perlRunnerIframe.onerror = () => {\n                clearTimeout(timeout);\n                window.removeEventListener('message', messageHandler);\n                reject(new Error(`Failed to load ${this.config.webperlBasePath}/perlrunner.html`));\n            };\n\n            document.body.appendChild(this.perlRunnerIframe);\n\n            const pollForRunner = setInterval(() => {\n                const runnerFrame = this.perlRunnerIframe?.contentWindow;\n                if (runnerFrame) {\n                    runnerFrame.postMessage(\n                        { perlRunnerDiscovery: 1 },\n                        '*'\n                    );\n                }\n            }, 100);\n\n            setTimeout(() => clearInterval(pollForRunner), 30000);\n        });\n    }\n\n    private async waitForInitialization(): Promise<void> {\n        while (this.initializing) {\n            await new Promise(resolve => setTimeout(resolve, 100));\n        }\n        if (!this.initialized) {\n            throw new Error('WebPerl initialization failed');\n        }\n    }\n\n    async runScript(\n        argv: string[],\n        inputs?: { fn: string; text: string }[],\n        outputs?: string[],\n        workingDir?: string\n    ): Promise<ScriptResult> {\n        if (!this.initialized || !this.perlRunner) {\n            throw new Error('WebPerl not initialized. Call initialize() first.');\n        }\n\n        const sortedInputs = this.sortInputsByDepth(inputs || []);\n\n        return new Promise((resolve, reject) => {\n            let stdout = '';\n            let stderr = '';\n            let exitStatus = 0;\n            const outputFiles: { fn: string; text: string }[] = [];\n\n            const messageHandler = (event: MessageEvent) => {\n                const data = event.data;\n\n                if (data.perlOutput) {\n                    if (data.perlOutput.chan === 1) {\n                        stdout += data.perlOutput.data;\n                    } else if (data.perlOutput.chan === 2) {\n                        stderr += data.perlOutput.data;\n                    }\n                } else if (data.perlOutputFiles) {\n                    outputFiles.push(...data.perlOutputFiles);\n                } else if (data.perlRunnerState === 'Ended') {\n                    window.removeEventListener('message', messageHandler);\n\n                    if ('exitStatus' in data) {\n                        exitStatus = data.exitStatus;\n                    }\n\n                    if (outputFiles.length > 0) {\n                        stdout = outputFiles[0].text;\n                    }\n\n                    resolve({\n                        success: exitStatus === 0,\n                        output: stdout,\n                        error: stderr || undefined,\n                        exitCode: exitStatus\n                    });\n                } else if (data.perlRunnerError) {\n                    window.removeEventListener('message', messageHandler);\n                    reject(new Error(data.perlRunnerError));\n                }\n            };\n\n            window.addEventListener('message', messageHandler);\n\n            const runData: any = { argv };\n            if (sortedInputs.length > 0) runData.inputs = sortedInputs;\n            if (outputs) runData.outputs = outputs;\n            if (workingDir) runData.cwd = workingDir;\n\n            if (!this.perlRunner) {\n                window.removeEventListener('message', messageHandler);\n                reject(new Error('Perl runner not available'));\n                return;\n            }\n\n            this.perlRunner.postMessage({ runPerl: runData }, '*');\n\n            setTimeout(() => {\n                window.removeEventListener('message', messageHandler);\n                reject(new Error('Timeout waiting for script execution'));\n            }, 60000);\n        });\n    }\n\n    private sortInputsByDepth(inputs: { fn: string; text: string }[]): { fn: string; text: string }[] {\n        return inputs.slice().sort((a, b) => {\n            const depthA = a.fn.split('/').length;\n            const depthB = b.fn.split('/').length;\n            return depthA - depthB;\n        });\n    }\n\n    isInitialized(): boolean {\n        return this.initialized;\n    }\n\n    getConfig(): Required<WebPerlConfig> {\n        return { ...this.config };\n    }\n}","import { Logger } from '../utils/logger';\nimport { EmscriptenFS } from './types';\n\nexport class FileSystemManager {\n    private logger: Logger;\n    private fs!: EmscriptenFS;\n\n    constructor(verbose: boolean = false) {\n        this.logger = new Logger(verbose);\n    }\n\n    initialize(): void {\n        if (!window.FS) {\n            throw new Error('Emscripten FS not available');\n        }\n        this.fs = window.FS;\n        this.logger.debug('FileSystem initialized');\n    }\n\n    writeFile(path: string, content: string): void {\n        try {\n            this.ensureDirectory(path);\n            this.fs.writeFile(path, content, { encoding: 'utf8' });\n            this.logger.debug(`File written: ${path}`);\n        } catch (error) {\n            throw new Error(`Failed to write file ${path}: ${error}`);\n        }\n    }\n\n    readFile(path: string): string {\n        try {\n            const result = this.fs.readFile(path, { encoding: 'utf8' });\n            return typeof result === 'string' ? result : new TextDecoder().decode(result as Uint8Array);\n        } catch (error) {\n            throw new Error(`Failed to read file ${path}: ${error}`);\n        }\n    }\n\n    fileExists(path: string): boolean {\n        try {\n            this.fs.stat(path);\n            return true;\n        } catch {\n            return false;\n        }\n    }\n\n    private ensureDirectory(filePath: string): void {\n        const dir = filePath.substring(0, filePath.lastIndexOf('/'));\n        if (!dir) return;\n\n        const parts = dir.split('/').filter(p => p);\n        let currentPath = '';\n\n        for (const part of parts) {\n            currentPath += '/' + part;\n            try {\n                this.fs.mkdir(currentPath);\n            } catch (error: any) {\n                if (error.code && error.code !== 'EEXIST') {\n                    throw error;\n                }\n            }\n        }\n    }\n\n    deleteFile(path: string): void {\n        try {\n            if (this.fileExists(path)) {\n                this.fs.unlink(path);\n                this.logger.debug(`File deleted: ${path}`);\n            }\n        } catch (error) {\n            throw new Error(`Failed to delete file ${path}: ${error}`);\n        }\n    }\n}","import { PerlScript } from './types';\nimport { FileSystemManager } from './filesystem-manager';\nimport { Logger } from '../utils/logger';\n\nexport class ScriptLoader {\n    private fsManager: FileSystemManager;\n    private logger: Logger;\n    private loadedScripts: Set<string> = new Set();\n\n    constructor(fsManager: FileSystemManager, verbose: boolean = false) {\n        this.fsManager = fsManager;\n        this.logger = new Logger(verbose);\n    }\n\n    async loadScript(script: PerlScript, basePath: string): Promise<void> {\n        if (this.loadedScripts.has(script.name)) {\n            this.logger.debug(`Script already loaded: ${script.name}`);\n            return;\n        }\n\n        this.logger.info(`Loading script: ${script.name}`);\n\n        try {\n            await this.loadDependencies(script, basePath);\n            await this.loadMainScript(script, basePath);\n\n            this.loadedScripts.add(script.name);\n            this.logger.info(`Script loaded successfully: ${script.name}`);\n        } catch (error) {\n            throw new Error(`Failed to load script ${script.name}: ${error}`);\n        }\n    }\n\n    private async loadDependencies(script: PerlScript, basePath: string): Promise<void> {\n        for (const dep of script.dependencies) {\n            await this.loadFile(dep, basePath);\n        }\n    }\n\n    private async loadMainScript(script: PerlScript, basePath: string): Promise<void> {\n        await this.loadFile(script.path, basePath);\n    }\n\n    private async loadFile(path: string, basePath: string): Promise<void> {\n        const fullUrl = `${basePath}${path}`;\n        const virtualPath = `/perl${path}`;\n\n        try {\n            const response = await fetch(fullUrl);\n            if (!response.ok) {\n                throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n            }\n\n            const content = await response.text();\n            this.fsManager.writeFile(virtualPath, content);\n\n            this.logger.debug(`Loaded file: ${virtualPath}`);\n        } catch (error) {\n            throw new Error(`Failed to fetch ${fullUrl}: ${error}`);\n        }\n    }\n\n    isLoaded(scriptName: string): boolean {\n        return this.loadedScripts.has(scriptName);\n    }\n}","import { WebPerlRunner } from '../core/webperl-runner';\nimport { ScriptResult, ScriptRunOptions, LatexDiffOptions } from '../core/types';\nimport { Logger } from '../utils/logger';\n\ntype VfsInput = { fn: string; text: string };\n\nexport abstract class BaseTool {\n    protected runner: WebPerlRunner;\n    protected logger: Logger;\n    private filesLoaded = false;\n    public preloadedFiles: VfsInput[] = [];\n\n    constructor(runner: WebPerlRunner, verbose: boolean = false) {\n        this.runner = runner;\n        this.logger = new Logger(verbose);\n    }\n\n    abstract getScriptPath(): string;\n    abstract getDependencyPaths(): string[];\n\n    protected async ensureLoaded(): Promise<void> {\n        if (!this.runner.isInitialized()) {\n            await this.runner.initialize();\n        }\n        if (!this.filesLoaded) {\n            await this.fetchAllFiles();\n            this.filesLoaded = true;\n        }\n    }\n\n    private async fetchAllFiles(): Promise<void> {\n        const config = this.runner.getConfig();\n        const filesToLoad = [\n            { path: this.getScriptPath(), virtual: this.getScriptPath() },\n            ...this.getDependencyPaths().map(path => ({ path, virtual: path })),\n        ];\n\n        const inputs: VfsInput[] = [];\n        for (const file of filesToLoad) {\n            const url = `${config.perlScriptsPath}${file.path}`;\n            this.logger.debug(`Fetching file from ${url}`);\n            try {\n                const resp = await fetch(url);\n                if (!resp.ok) throw new Error(`HTTP ${resp.status}: ${resp.statusText}`);\n                const content = await resp.text();\n                inputs.push({ fn: file.virtual, text: content });\n                this.logger.debug(`Fetched: ${file.path}`);\n            } catch (err) {\n                throw new Error(`Failed to load file ${file.path}: ${err}`);\n            }\n        }\n        this.preloadedFiles = inputs;\n    }\n\n    protected async executeLatexDiff(options: LatexDiffOptions): Promise<ScriptResult> {\n        await this.ensureLoaded();\n\n        const t = Date.now();\n        const oldPath = `/tmp/old_${t}.tex`;\n        const newPath = `/tmp/new_${t}.tex`;\n        const outputPath = `/tmp/diff_${t}.tex`;\n\n        const args = this.buildArguments(oldPath, newPath, outputPath, options);\n\n        const inputs = [\n            ...this.preloadedFiles,\n            { fn: oldPath, text: options.oldContent },\n            { fn: newPath, text: options.input }\n        ];\n        const outputs = [outputPath];\n\n        return this.runner.runScript(args, inputs, outputs);\n    }\n\n    protected async executeScript(options: ScriptRunOptions): Promise<ScriptResult> {\n        await this.ensureLoaded();\n\n        const t = Date.now();\n        const inputPath = `/tmp/input_${t}.tex`;\n        const outputPath = `/tmp/output_${t}.tex`;\n\n        const args = this.buildArguments(inputPath, \"\", outputPath, options);\n\n        const inputs = [\n            ...this.preloadedFiles,\n            { fn: inputPath, text: options.input },\n        ];\n        const outputs = [outputPath];\n\n        return this.runner.runScript(args, inputs, outputs);\n    }\n\n    protected abstract buildArguments(\n        inputPath: string,\n        newPath: string,\n        outputPath: string,\n        options: ScriptRunOptions\n    ): string[];\n}","import { BaseTool } from './base-tool';\nimport { TexCountOptions, ScriptResult, ScriptRunOptions } from '../core/types';\n\nexport class TexCount extends BaseTool {\n    getScriptPath(): string {\n        return '/texcount.pl';\n    }\n\n    getDependencyPaths(): string[] {\n        return [];\n    }\n\n    async count(options: TexCountOptions): Promise<ScriptResult> {\n        return this.executeScriptWithWorkDir(options);\n    }\n\n    private async executeScriptWithWorkDir(options: TexCountOptions): Promise<ScriptResult> {\n        await this.ensureLoaded();\n\n        const t = Date.now();\n        const workDir = `/tmp/work_${t}`;\n        const inputPath = `${workDir}/main.tex`;\n        const outputPath = `/tmp/output_${t}.tex`;\n\n        const args = this.buildArguments('main.tex', \"\", outputPath, options);\n\n        const inputs = [\n            ...this.preloadedFiles,\n            { fn: inputPath, text: options.input },\n        ];\n\n        if (options.additionalFiles) {\n            for (const file of options.additionalFiles) {\n                const fullPath = `${workDir}/${file.path}`;\n                inputs.push({ fn: fullPath, text: file.content });\n            }\n        }\n\n        const outputs = [outputPath];\n\n        return this.runner.runScript(args, inputs, outputs, workDir);\n    }\n\n    protected buildArguments(\n        inputPath: string,\n        newPath: \"\",\n        outputPath: string,\n        options: ScriptRunOptions\n    ): string[] {\n        const texOptions = options as TexCountOptions;\n        const scriptPath = this.getScriptPath();\n\n        const args = [scriptPath];\n\n        if (texOptions.brief) args.push('-brief');\n        if (texOptions.total) args.push('-total');\n        if (texOptions.sum) args.push('-sum');\n        if (texOptions.verbose !== undefined) args.push(`-v${texOptions.verbose}`);\n        if (texOptions.includeFiles) args.push('-inc');\n        if (texOptions.merge) args.push('-merge');\n        if (texOptions.args) args.push(...texOptions.args);\n\n        args.push(inputPath);\n\n        return args;\n    }\n\n    parseOutput(output: string): TexCountResult {\n        const lines = output.trim().split('\\n');\n        const result: TexCountResult = {\n            words: 0,\n            headers: 0,\n            captions: 0,\n            raw: output\n        };\n\n        for (const line of lines) {\n            if (line.includes('Words in text:')) {\n                result.words = parseInt(line.split(':')[1].trim(), 10) || 0;\n            } else if (line.includes('Words in headers:')) {\n                result.headers = parseInt(line.split(':')[1].trim(), 10) || 0;\n            } else if (line.includes('Words outside text')) {\n                result.captions = parseInt(line.split(':')[1].trim(), 10) || 0;\n            }\n        }\n\n        return result;\n    }\n}\n\nexport interface TexCountResult {\n    words: number;\n    headers: number;\n    captions: number;\n    raw: string;\n}","import { BaseTool } from './base-tool';\nimport { LatexDiffOptions, ScriptResult, ScriptRunOptions } from '../core/types';\n\nexport class LatexDiff extends BaseTool {\n    getScriptPath(): string {\n        return '/latexdiff.pl';\n    }\n\n    getDependencyPaths(): string[] {\n        return [];\n    }\n\n    async diff(oldContent: string, newContent: string, options?: LatexDiffOptions): Promise<ScriptResult> {\n        const mergedOptions: LatexDiffOptions = {\n            input: newContent,\n            oldContent,\n            ...options\n        };\n        return this.executeLatexDiff(mergedOptions);\n    }\n\n    protected async executeLatexDiff(options: LatexDiffOptions): Promise<ScriptResult> {\n        await this.ensureLoaded();\n\n        const t = Date.now();\n        const oldPath = `/tmp/old_${t}.tex`;\n        const newPath = `/tmp/new_${t}.tex`;\n        const outputPath = `/tmp/diff_${t}.tex`;\n\n        const args = this.buildArguments(oldPath, newPath, outputPath, options);\n\n        const inputs = [\n            ...this.preloadedFiles,\n            { fn: oldPath, text: options.oldContent },\n            { fn: newPath, text: options.input }\n        ];\n        const outputs = [outputPath];\n\n        return this.runner.runScript(args, inputs, outputs);\n    }\n\n    protected buildArguments(\n        oldPath: string,\n        newPath: string,\n        outputPath: string,\n        options: ScriptRunOptions\n    ): string[] {\n        const diffOptions = options as LatexDiffOptions;\n        const scriptPath = this.getScriptPath();\n\n        const args = [scriptPath];\n\n        if (diffOptions.type) args.push(`--type=${diffOptions.type}`);\n        if (diffOptions.subtype) args.push(`--subtype=${diffOptions.subtype}`);\n        if (diffOptions.floattype) args.push(`--floattype=${diffOptions.floattype}`);\n        if (diffOptions.encoding) args.push(`--encoding=${diffOptions.encoding}`);\n        if (diffOptions.excludeSafecmd) args.push(`--exclude-safecmd=${diffOptions.excludeSafecmd}`);\n        if (diffOptions.appendSafecmd) args.push(`--append-safecmd=${diffOptions.appendSafecmd}`);\n        if (diffOptions.excludeTextcmd) args.push(`--exclude-textcmd=${diffOptions.excludeTextcmd}`);\n        if (diffOptions.appendTextcmd) args.push(`--append-textcmd=${diffOptions.appendTextcmd}`);\n        if (diffOptions.mathMarkup !== undefined) args.push(`--math-markup=${diffOptions.mathMarkup}`);\n        if (diffOptions.allowSpaces) args.push('--allow-spaces');\n        if (diffOptions.flatten) args.push('--flatten');\n\n        args.push(oldPath, newPath);\n\n        return args;\n    }\n}","import { TexFmtOptions, ScriptResult } from '../core/types';\nimport { Logger } from '../utils/logger';\nimport { ErrorHandler } from '../utils/error-handler';\n\nexport class TexFmt {\n    private logger: Logger;\n    private wasmInitialized: boolean = false;\n    private wasmModule: any = null;\n    private wasmBasePath: string;\n\n    constructor(verbose: boolean = false, wasmBasePath: string = '/core/texfmt') {\n        this.logger = new Logger(verbose);\n        this.wasmBasePath = wasmBasePath;\n    }\n\n    private async ensureWasmLoaded(): Promise<void> {\n        if (this.wasmInitialized && this.wasmModule) {\n            return;\n        }\n\n        try {\n            const wasmModule = await import(/* webpackIgnore: true */ `${this.wasmBasePath}/tex_fmt.js`);\n            await wasmModule.default();\n            this.wasmModule = wasmModule;\n            this.wasmInitialized = true;\n            this.logger.debug('tex-fmt WASM module initialized');\n        } catch (error) {\n            throw ErrorHandler.handle(error, 'Failed to load tex-fmt WASM module');\n        }\n    }\n\n    private buildConfig(options: TexFmtOptions): string {\n        const config: string[] = ['# tex-fmt.toml'];\n\n        if (options.wrap !== undefined) {\n            config.push(`wrap = ${options.wrap}`);\n        }\n        if (options.wraplen !== undefined) {\n            config.push(`wraplen = ${options.wraplen}`);\n        }\n        if (options.tabsize !== undefined) {\n            config.push(`tabsize = ${options.tabsize}`);\n        }\n        if (options.usetabs !== undefined) {\n            config.push(`tabchar = \"${options.usetabs ? 'tab' : 'space'}\"`);\n        }\n\n        config.push('lists = []');\n        config.push('no-indent-envs = []');\n\n        return config.join('\\n');\n    }\n\n    async format(options: TexFmtOptions): Promise<ScriptResult> {\n        await this.ensureWasmLoaded();\n\n        try {\n            const config = this.buildConfig(options);\n            this.logger.debug(`Running tex-fmt with config:\\n${config}`);\n\n            const result = this.wasmModule.main(options.input, config);\n\n            return {\n                success: true,\n                output: result.output,\n                error: result.logs || undefined,\n                exitCode: 0\n            };\n        } catch (error) {\n            const errorMsg = ErrorHandler.getMessage(error);\n            this.logger.error('tex-fmt formatting failed:', errorMsg);\n\n            return {\n                success: false,\n                output: '',\n                error: errorMsg,\n                exitCode: 1\n            };\n        }\n    }\n}","import { BaseTool } from './base-tool';\nimport { LatexpandOptions, ScriptResult, ScriptRunOptions } from '../core/types';\n\nexport class Latexpand extends BaseTool {\n    getScriptPath(): string {\n        return '/latexpand.pl';\n    }\n\n    getDependencyPaths(): string[] {\n        return [];\n    }\n\n    async expand(options: LatexpandOptions): Promise<ScriptResult> {\n        return this.executeScriptWithWorkDir(options);\n    }\n\n    private async executeScriptWithWorkDir(options: LatexpandOptions): Promise<ScriptResult> {\n        await this.ensureLoaded();\n\n        const t = Date.now();\n        const workDir = `/tmp/work_${t}`;\n        const inputPath = `${workDir}/main.tex`;\n\n        const args = this.buildArguments('main.tex', \"\", '', options);\n\n        const inputs = [\n            ...this.preloadedFiles,\n            { fn: inputPath, text: options.input },\n        ];\n\n        if (options.additionalFiles) {\n            for (const file of options.additionalFiles) {\n                const fullPath = `${workDir}/${file.path}`;\n                inputs.push({ fn: fullPath, text: file.content });\n            }\n        }\n\n        const result = await this.runner.runScript(args, inputs, undefined, workDir);\n\n        if (result.success && result.output && result.output.trim()) {\n            return result;\n        }\n\n        if (result.success && (!result.output || !result.output.trim())) {\n            return {\n                success: false,\n                output: '',\n                error: `Latexpand produced no output. Exit code: ${result.exitCode}\\nSTDOUT length: ${result.output?.length || 0}\\nSTDERR: ${result.error || 'none'}`,\n                exitCode: result.exitCode\n            };\n        }\n\n        return result;\n    }\n\n    protected buildArguments(\n        inputPath: string,\n        newPath: string,\n        outputPath: string,\n        options: ScriptRunOptions\n    ): string[] {\n        const expandOptions = options as LatexpandOptions;\n        const scriptPath = this.getScriptPath();\n\n        const args = [scriptPath];\n\n        if (expandOptions.keepComments) args.push('--keep-comments');\n        if (expandOptions.keepIncludes) args.push('--keep-includes');\n        if (expandOptions.emptyComments) args.push('--empty-comments');\n        if (expandOptions.defines) {\n            for (const [key, value] of Object.entries(expandOptions.defines)) {\n                args.push('--define', `${key}=${value}`);\n            }\n        }\n        if (expandOptions.explain) args.push('--explain');\n        if (expandOptions.showGraphics) args.push('--show-graphics');\n        if (expandOptions.graphicsExtensions) {\n            args.push('--graphics-extensions', expandOptions.graphicsExtensions);\n        }\n        if (expandOptions.expandUsepackage) args.push('--expand-usepackage');\n        if (expandOptions.expandBbl) args.push('--expand-bbl', expandOptions.expandBbl);\n        if (expandOptions.biber) args.push('--biber', expandOptions.biber);\n        if (expandOptions.fatal) args.push('--fatal');\n        if (expandOptions.makeatletter) args.push('--makeatletter');\n\n        if (expandOptions.args) args.push(...expandOptions.args);\n\n        args.push(inputPath);\n\n        return args;\n    }\n}"],"names":[],"mappings":"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"}